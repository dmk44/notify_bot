# notify-bot

[English](README.md) | **Русский**

Простой Python‑CLI для рассылки сообщений в ваш Telegram‑бот.

**Что она делает?** 

Отправляет сообщения из консоли в телеграм бота. По сути каждый бот - пейджер, а оператор - это консоль *Bash* или *PowerShell*.

## Требования:
* Python **3.9+**

## Установка

В корне проекта:

```bash
sudo apt update && sudo apt upgrade
git clone https://github.com/dmk44/notify_bot.git
cd notify_bot
pip install .
```
На Windows этого достаточно.
На Linux и macOS может потребоваться установка в виртуальное окружение
или использование `pipx`.

**Если ставите через pipx:** если pipx пишет, что каталог «not on your PATH», выполните `pipx ensurepath`, затем перезапустите терминал (или выполните `source ~/.bashrc`).

---

После установки будут доступны консольные команды:

- `set-token` — задать токен бота и сохранить его в конфиг;
- `start-bot` — запустить бота, режим сбора пользователей в список рассылки;
- `send-message` — разослать сообщение всем сохранённым пользователям в списке;
- `clear-users` — очистить список пользователей;
- `clear-token` — удалить токен.

## Настройка

1. Получите токен у [@BotFather](https://t.me/BotFather).
2. Выполните команду:

```bash
set-token
```

Вы вводите токен и скрипт сохранит токен в `~/.notify-bot/config.ini`;
попробует автоматически определить `@имя_бота` через Telegram API;
выведет сообщение вида: `Токен для бота @bot_name установлен.`

## Использование

1. Запустите бота:

```bash
start-bot
```

2. Пока активна команда `start-bot`, в Telegram нажмите `/start` в вашем боте с нужных аккаунтов.
   Каждый аккаунт будет добавлен в список рассылки и увидит сообщение:

> Привет от Notify-bot ;-)..  
> Вы добавлены в список рассылки этого бота.  
> Бот: @bot_name

**Примечание:**
Команде `start-bot` не требуется быть запущенной постоянно.
После того как пользователи добавлены, команду `start-bot` можно прервать в любой момент. Список пользователей сохраняется локально и контролируется.
Хранится он в `~/.notify-bot/users.json`

3. Отправьте рассылку:

```sh
send-message "Ваш текст сообщения"
```
В бота придёт данное сообщение с терминала.
## Безопасность

Токен Telegram-бота даёт полный контроль над ботом, поэтому относитесь к нему как к паролю.
По умолчанию notify-bot хранит токен локально.
Шифрование токена в файле без отдельного секрета не даёт существенного выигрыша в безопасности.

### Linux / macOS

Выполните команды:
```bash
chmod 700 ~/.notify-bot
chmod 600 ~/.notify-bot/config.ini
chmod 600 ~/.notify-bot/users.json
```
Это запретит другим пользователям системы читать токен и список рассылки.

### Windows
Используется стандартная модель безопасности папки пользователя.
Дополнительных действий обычно не требуется.


## Очистка и удаление

- `clear-users` — удаляет `~/.notify-bot/users.json` (список пользователей);
- `clear-token` — удаляет `~/.notify-bot/config.ini` и при необходимости саму директорию `~/.notify-bot`.
- `pip uninstall notify` - удаляет модуль из Python.